<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>부트스트랩 Progress Bar 실습</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 50px; }
        .progress { margin-bottom: 20px; height: 30px; }
    </style>
</head>

<body>
    <div class="progress" role="progressbar" aria-label="Example with label" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
        <div id="p-bar" class="progress-bar" style="width: 0%">0%</div>
    </div>

    <button type="button" id="start-btn" class="btn btn-primary">Primary</button>

    <script>
        const pBar = document.getElementById('p-bar');
        const startBtn = document.getElementById('start-btn');

        startBtn.addEventListener('click', function () {
            // 1. 버튼 비활성화 (작업 시작 시 중복 클릭 방지)
            startBtn.disabled = true;
            
            let currentProgress = 0;
            updateUI(0);

            // 2. 3초 ~ 5초 사이의 랜덤 종료 시간 설정
            const finishTime = Math.floor(Math.random() * (5000 - 3000 + 1)) + 3000;
            console.log(`작업이 ${finishTime}ms 후에 완료됩니다.`);

            // 3. 1초마다 10%씩 증가하는 타이머
            const intervalId = setInterval(() => {
                currentProgress += 10;
                if (currentProgress < 100) {
                    updateUI(currentProgress);
                }
            }, 1000);

            // 4. 랜덤 시간이 되면 100%로 만들고 버튼 다시 활성화
            setTimeout(() => {
                clearInterval(intervalId); // 증가 타이머 정지
                updateUI(100);             // 100%로 변경
                
                // [수정된 부분] 작업 완료 후 버튼 다시 활성화
                startBtn.disabled = false; 
                console.log("작업 완료! 버튼이 다시 활성화되었습니다.");
            }, finishTime);
        });

        function updateUI(value) {
            pBar.style.width = value + '%';
            pBar.innerText = value + '%';
            pBar.parentElement.setAttribute('aria-valuenow', value);
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>